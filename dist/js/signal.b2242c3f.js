"use strict";(self["webpackChunkwavetune"]=self["webpackChunkwavetune"]||[]).push([[731],{138:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});a(8111),a(1701);var s=a(6768),l=a(4232);const n={class:"signal-monitor-view"},i={class:"top-section"},o={class:"header-content"},c={class:"status-info"},r={class:"signal-modules"},d={class:"card-header"},u={class:"signal-name"},k={class:"signal-data"},m={class:"data-value"},p={class:"value-text"},v={class:"value-unit"},g={class:"reference-range"},f={class:"waveform-container"},h={class:"waveform",viewBox:"0 0 400 120"},y=["d","stroke"],b={class:"bottom-section"},F={class:"timeline-section"},_={class:"timeline"},L={class:"time-marks"},w={class:"action-buttons"},C={key:0,class:"detection-result",style:{"margin-left":"12px",display:"flex","align-items":"center",gap:"8px"}},R={class:"prob"};function E(e,t,a,E,x,M){const Q=(0,s.g2)("el-page-header"),V=(0,s.g2)("el-tag"),W=(0,s.g2)("el-badge"),X=(0,s.g2)("el-card"),D=(0,s.g2)("el-col"),I=(0,s.g2)("el-row"),z=(0,s.g2)("VideoPause"),G=(0,s.g2)("el-icon"),S=(0,s.g2)("el-button"),$=(0,s.g2)("Download");return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",i,[(0,s.Lk)("div",o,[(0,s.bF)(Q,{content:"多模态生理信号实时监测",class:"page-title"}),(0,s.Lk)("div",c,[(0,s.bF)(V,{type:"success",size:"large"},{default:(0,s.k6)(()=>[...t[1]||(t[1]=[(0,s.eW)("监测中",-1)])]),_:1}),t[2]||(t[2]=(0,s.Lk)("span",{class:"device-status"},"设备已连接",-1))])]),t[3]||(t[3]=(0,s.Lk)("p",{class:"monitor-info"}," 当前监测信号：EEG、EOG、HRV、呼吸频率 ",-1))]),(0,s.Lk)("div",r,[(0,s.bF)(I,{gutter:16},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(x.signalModules,e=>((0,s.uX)(),(0,s.Wv)(D,{key:e.type,xs:24,sm:24,md:12,lg:12,xl:12},{default:(0,s.k6)(()=>[(0,s.bF)(X,{class:(0,l.C4)(["signal-card",e.status])},{header:(0,s.k6)(()=>[(0,s.Lk)("div",d,[(0,s.Lk)("span",u,(0,l.v_)(e.name),1),(0,s.bF)(W,{type:"normal"===e.status?"success":"danger",value:"normal"===e.status?"正常":"异常"},null,8,["type","value"])])]),default:(0,s.k6)(()=>[(0,s.Lk)("div",k,[(0,s.Lk)("div",m,[(0,s.Lk)("span",p,(0,l.v_)(e.value),1),(0,s.Lk)("span",v,(0,l.v_)(e.unit),1)]),(0,s.Lk)("div",g,(0,l.v_)(e.range),1)]),(0,s.Lk)("div",f,[((0,s.uX)(),(0,s.CE)("svg",h,[t[4]||(t[4]=(0,s.Lk)("line",{x1:"0",y1:"30",x2:"400",y2:"30",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),t[5]||(t[5]=(0,s.Lk)("line",{x1:"0",y1:"60",x2:"400",y2:"60",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),t[6]||(t[6]=(0,s.Lk)("line",{x1:"0",y1:"90",x2:"400",y2:"90",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),(0,s.Lk)("path",{d:e.waveform,stroke:e.color,"stroke-width":"2",fill:"none",class:"waveform-path"},null,8,y)]))])]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),(0,s.Lk)("div",b,[(0,s.Lk)("div",F,[t[8]||(t[8]=(0,s.Lk)("div",{class:"timeline-header"},[(0,s.Lk)("span",{class:"timeline-title"},"监测时间轴"),(0,s.Lk)("span",{class:"current-time"},"当前时间: 00:03")],-1)),(0,s.Lk)("div",_,[(0,s.Lk)("div",L,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(x.timeMarks,e=>((0,s.uX)(),(0,s.CE)("span",{key:e,class:(0,l.C4)(["time-mark",{current:"00:03"===e}])},(0,l.v_)(e),3))),128))]),t[7]||(t[7]=(0,s.Lk)("div",{class:"timeline-progress"},[(0,s.Lk)("div",{class:"progress-line"}),(0,s.Lk)("div",{class:"current-indicator",style:{left:"60%"}})],-1))])]),(0,s.Lk)("div",w,[(0,s.bF)(S,{type:"default",size:"large"},{default:(0,s.k6)(()=>[(0,s.bF)(G,null,{default:(0,s.k6)(()=>[(0,s.bF)(z)]),_:1}),t[9]||(t[9]=(0,s.eW)(" 暂停监测 ",-1))]),_:1}),(0,s.bF)(S,{type:"primary",size:"large"},{default:(0,s.k6)(()=>[(0,s.bF)(G,null,{default:(0,s.k6)(()=>[(0,s.bF)($)]),_:1}),t[10]||(t[10]=(0,s.eW)(" 导出数据 ",-1))]),_:1}),(0,s.Lk)("input",{ref:"csvInput",type:"file",accept:".csv",style:{display:"none"},onChange:t[0]||(t[0]=(...e)=>M.onFileChange&&M.onFileChange(...e))},null,544),(0,s.bF)(S,{type:"info",size:"large",onClick:M.chooseFile,style:{"margin-left":"12px"}},{default:(0,s.k6)(()=>[...t[11]||(t[11]=[(0,s.eW)(" 选择 CSV ",-1)])]),_:1},8,["onClick"]),(0,s.bF)(S,{disabled:!x.selectedFile,loading:x.detecting,type:"success",size:"large",onClick:M.uploadCsvForDetection},{default:(0,s.k6)(()=>[...t[12]||(t[12]=[(0,s.eW)(" 上传检测 ",-1)])]),_:1},8,["disabled","loading","onClick"]),x.detectionResult?((0,s.uX)(),(0,s.CE)("div",C,[(0,s.bF)(V,{type:x.detectionResult.type||"warning"},{default:(0,s.k6)(()=>[(0,s.eW)("检测："+(0,l.v_)(x.detectionResult.label_name),1)]),_:1},8,["type"]),(0,s.Lk)("span",R,"概率: "+(0,l.v_)(x.detectionResult.probabilities.map(e=>e.toFixed(3)).join(" / ")),1),"Medium"===x.detectionResult.label_name||"High"===x.detectionResult.label_name?((0,s.uX)(),(0,s.Wv)(S,{key:0,type:"primary",size:"small",onClick:M.showRecommendations},{default:(0,s.k6)(()=>[...t[13]||(t[13]=[(0,s.eW)("查看推荐音乐",-1)])]),_:1},8,["onClick"])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)])])])}a(4114);var x=a(7477),M=a(5720),Q=a(1219),V={name:"SignalMonitorView",components:{VideoPause:x.VideoPause,Download:x.Download},data(){return{signalModules:[{type:"EEG",name:"EEG 脑电信号",value:"4.2",unit:"μV²",range:"正常范围：5-8 μV²",status:"warning",color:"#1890ff",waveform:"M0,60 Q50,20 100,60 T200,60 T300,60 T400,60"},{type:"EOG",name:"EOG 眼电信号",value:"18.5",unit:"次/分",range:"正常范围：15-20 次/分",status:"normal",color:"#722ed1",waveform:"M0,60 Q100,30 200,60 Q300,90 400,60"},{type:"HRV",name:"心率变异性",value:"32.4",unit:"ms",range:"正常范围：30-50 ms",status:"normal",color:"#52c41a",waveform:"M0,60 Q50,40 100,60 Q150,80 200,60 Q250,40 300,60 Q350,80 400,60"},{type:"RESP",name:"呼吸频率",value:"16.2",unit:"次/分",range:"正常范围：12-20 次/分",status:"normal",color:"#fa8c16",waveform:"M0,60 Q100,40 200,60 Q300,80 400,60"}],selectedFileName:"",selectedFile:null,detecting:!1,detectionResult:null,timeMarks:["00:00","00:01","00:02","00:03","00:04","00:05"]}},methods:{chooseFile(){this.$refs.csvInput&&this.$refs.csvInput.click()},onFileChange(e){const t=e.target.files||e.dataTransfer?.files;if(!t||!t.length)return this.selectedFile=null,void(this.selectedFileName="");const a=t[0];this.selectedFile=a,this.selectedFileName=a.name},async uploadCsvForDetection(){if(!this.selectedFile)return void Q.nk.warning("请先选择一个 CSV 文件");const e=new FormData;e.append("file",this.selectedFile),this.detecting=!0,this.detectionResult=null;try{const t=await M.f.postForm("/detection/upload",e),a=t.data||{};this.detectionResult={label:a.label,label_name:a.label_name||a.labelName||"Unknown",probabilities:a.probabilities||a.probs||[],type:"High"===a.label_name?"danger":"Medium"===a.label_name?"warning":"success"},Q.nk.success(`检测完成：${this.detectionResult.label_name}`)}catch(t){console.error("uploadCsvForDetection error",t),Q.nk.error("上传或检测失败，请检查文件格式（20×20）并重试")}finally{this.detecting=!1}},showRecommendations(){try{if(this.detectionResult&&this.detectionResult.label_name)try{localStorage.setItem("current_fatigue_level",this.detectionResult.label_name)}catch(e){}this.$router&&this.$router.push({path:"/music-recommendation"})}catch(e){Q.nk.info("请在推荐页面查看推荐列表")}}}},W=a(1241);const X=(0,W.A)(V,[["render",E],["__scopeId","data-v-2645ad5f"]]);var D=X}}]);
//# sourceMappingURL=signal.b2242c3f.js.map