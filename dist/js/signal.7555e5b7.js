"use strict";(self["webpackChunkwavetune"]=self["webpackChunkwavetune"]||[]).push([[731],{138:function(e,t,n){n.r(t),n.d(t,{default:function(){return W}});n(8111),n(1701);var r=n(641),o=n(33);const a={class:"signal-monitor-view"},i={class:"top-section"},s={class:"header-content"},l={class:"status-info"},c={class:"signal-modules"},u={class:"card-header"},d={class:"signal-name"},f={class:"signal-data"},p={class:"data-value"},v={class:"value-text"},h={class:"value-unit"},m={class:"reference-range"},y={class:"waveform-container"},g={class:"waveform",viewBox:"0 0 400 120"},k=["d","stroke"],b={class:"bottom-section"},w={class:"timeline-section"},x={class:"timeline"},F={class:"time-marks"},_={class:"action-buttons"},L={key:0,class:"detection-result",style:{"margin-left":"12px",display:"flex","align-items":"center",gap:"8px"}},I={class:"prob"};function C(e,t,n,C,R,E){const O=(0,r.g2)("el-page-header"),T=(0,r.g2)("el-tag"),j=(0,r.g2)("el-badge"),P=(0,r.g2)("el-card"),W=(0,r.g2)("el-col"),H=(0,r.g2)("el-row"),M=(0,r.g2)("VideoPause"),Q=(0,r.g2)("el-icon"),V=(0,r.g2)("el-button"),S=(0,r.g2)("Download");return(0,r.uX)(),(0,r.CE)("div",a,[(0,r.Lk)("div",i,[(0,r.Lk)("div",s,[(0,r.bF)(O,{content:"多模态生理信号实时监测",class:"page-title"}),(0,r.Lk)("div",l,[(0,r.bF)(T,{type:"success",size:"large"},{default:(0,r.k6)(()=>[...t[1]||(t[1]=[(0,r.eW)("监测中",-1)])]),_:1}),t[2]||(t[2]=(0,r.Lk)("span",{class:"device-status"},"设备已连接",-1))])]),t[3]||(t[3]=(0,r.Lk)("p",{class:"monitor-info"}," 当前监测信号：EEG、EOG、HRV、呼吸频率 ",-1))]),(0,r.Lk)("div",c,[(0,r.bF)(H,{gutter:16},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(R.signalModules,e=>((0,r.uX)(),(0,r.Wv)(W,{key:e.type,xs:24,sm:24,md:12,lg:12,xl:12},{default:(0,r.k6)(()=>[(0,r.bF)(P,{class:(0,o.C4)(["signal-card",e.status])},{header:(0,r.k6)(()=>[(0,r.Lk)("div",u,[(0,r.Lk)("span",d,(0,o.v_)(e.name),1),(0,r.bF)(j,{type:"normal"===e.status?"success":"danger",value:"normal"===e.status?"正常":"异常"},null,8,["type","value"])])]),default:(0,r.k6)(()=>[(0,r.Lk)("div",f,[(0,r.Lk)("div",p,[(0,r.Lk)("span",v,(0,o.v_)(e.value),1),(0,r.Lk)("span",h,(0,o.v_)(e.unit),1)]),(0,r.Lk)("div",m,(0,o.v_)(e.range),1)]),(0,r.Lk)("div",y,[((0,r.uX)(),(0,r.CE)("svg",g,[t[4]||(t[4]=(0,r.Lk)("line",{x1:"0",y1:"30",x2:"400",y2:"30",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),t[5]||(t[5]=(0,r.Lk)("line",{x1:"0",y1:"60",x2:"400",y2:"60",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),t[6]||(t[6]=(0,r.Lk)("line",{x1:"0",y1:"90",x2:"400",y2:"90",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),(0,r.Lk)("path",{d:e.waveform,stroke:e.color,"stroke-width":"2",fill:"none",class:"waveform-path"},null,8,k)]))])]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),(0,r.Lk)("div",b,[(0,r.Lk)("div",w,[t[8]||(t[8]=(0,r.Lk)("div",{class:"timeline-header"},[(0,r.Lk)("span",{class:"timeline-title"},"监测时间轴"),(0,r.Lk)("span",{class:"current-time"},"当前时间: 00:03")],-1)),(0,r.Lk)("div",x,[(0,r.Lk)("div",F,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(R.timeMarks,e=>((0,r.uX)(),(0,r.CE)("span",{key:e,class:(0,o.C4)(["time-mark",{current:"00:03"===e}])},(0,o.v_)(e),3))),128))]),t[7]||(t[7]=(0,r.Lk)("div",{class:"timeline-progress"},[(0,r.Lk)("div",{class:"progress-line"}),(0,r.Lk)("div",{class:"current-indicator",style:{left:"60%"}})],-1))])]),(0,r.Lk)("div",_,[(0,r.bF)(V,{type:"default",size:"large"},{default:(0,r.k6)(()=>[(0,r.bF)(Q,null,{default:(0,r.k6)(()=>[(0,r.bF)(M)]),_:1}),t[9]||(t[9]=(0,r.eW)(" 暂停监测 ",-1))]),_:1}),(0,r.bF)(V,{type:"primary",size:"large"},{default:(0,r.k6)(()=>[(0,r.bF)(Q,null,{default:(0,r.k6)(()=>[(0,r.bF)(S)]),_:1}),t[10]||(t[10]=(0,r.eW)(" 导出数据 ",-1))]),_:1}),(0,r.Lk)("input",{ref:"csvInput",type:"file",accept:".csv",style:{display:"none"},onChange:t[0]||(t[0]=(...e)=>E.onFileChange&&E.onFileChange(...e))},null,544),(0,r.bF)(V,{type:"info",size:"large",onClick:E.chooseFile,style:{"margin-left":"12px"}},{default:(0,r.k6)(()=>[...t[11]||(t[11]=[(0,r.eW)(" 选择 CSV ",-1)])]),_:1},8,["onClick"]),(0,r.bF)(V,{disabled:!R.selectedFile,loading:R.detecting,type:"success",size:"large",onClick:E.uploadCsvForDetection},{default:(0,r.k6)(()=>[...t[12]||(t[12]=[(0,r.eW)(" 上传检测 ",-1)])]),_:1},8,["disabled","loading","onClick"]),R.detectionResult?((0,r.uX)(),(0,r.CE)("div",L,[(0,r.bF)(T,{type:R.detectionResult.type||"warning"},{default:(0,r.k6)(()=>[(0,r.eW)("检测："+(0,o.v_)(R.detectionResult.label_name),1)]),_:1},8,["type"]),(0,r.Lk)("span",I,"概率: "+(0,o.v_)(R.detectionResult.probabilities.map(e=>e.toFixed(3)).join(" / ")),1),"Medium"===R.detectionResult.label_name||"High"===R.detectionResult.label_name?((0,r.uX)(),(0,r.Wv)(V,{key:0,type:"primary",size:"small",onClick:E.showRecommendations},{default:(0,r.k6)(()=>[...t[13]||(t[13]=[(0,r.eW)("查看推荐音乐",-1)])]),_:1},8,["onClick"])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0)])])])}n(4114);var R=n(8548),E=n(5720),O=n(163),T={name:"SignalMonitorView",components:{VideoPause:R.VideoPause,Download:R.Download},data(){return{signalModules:[{type:"EEG",name:"EEG 脑电信号",value:"4.2",unit:"μV²",range:"正常范围：5-8 μV²",status:"warning",color:"#1890ff",waveform:"M0,60 Q50,20 100,60 T200,60 T300,60 T400,60"},{type:"EOG",name:"EOG 眼电信号",value:"18.5",unit:"次/分",range:"正常范围：15-20 次/分",status:"normal",color:"#722ed1",waveform:"M0,60 Q100,30 200,60 Q300,90 400,60"},{type:"HRV",name:"心率变异性",value:"32.4",unit:"ms",range:"正常范围：30-50 ms",status:"normal",color:"#52c41a",waveform:"M0,60 Q50,40 100,60 Q150,80 200,60 Q250,40 300,60 Q350,80 400,60"},{type:"RESP",name:"呼吸频率",value:"16.2",unit:"次/分",range:"正常范围：12-20 次/分",status:"normal",color:"#fa8c16",waveform:"M0,60 Q100,40 200,60 Q300,80 400,60"}],selectedFileName:"",selectedFile:null,detecting:!1,detectionResult:null,timeMarks:["00:00","00:01","00:02","00:03","00:04","00:05"]}},methods:{chooseFile(){this.$refs.csvInput&&this.$refs.csvInput.click()},onFileChange(e){const t=e.target.files||e.dataTransfer?.files;if(!t||!t.length)return this.selectedFile=null,void(this.selectedFileName="");const n=t[0];this.selectedFile=n,this.selectedFileName=n.name},async uploadCsvForDetection(){if(!this.selectedFile)return void O.nk.warning("请先选择一个 CSV 文件");const e=new FormData;e.append("file",this.selectedFile),this.detecting=!0,this.detectionResult=null;try{const t=await E.f.postForm("/detection/upload",e),n=t.data||{};this.detectionResult={label:n.label,label_name:n.label_name||n.labelName||"Unknown",probabilities:n.probabilities||n.probs||[],type:"High"===n.label_name?"danger":"Medium"===n.label_name?"warning":"success"},O.nk.success(`检测完成：${this.detectionResult.label_name}`)}catch(t){console.error("uploadCsvForDetection error",t),O.nk.error("上传或检测失败，请检查文件格式（20×20）并重试")}finally{this.detecting=!1}},showRecommendations(){try{if(this.detectionResult&&this.detectionResult.label_name)try{localStorage.setItem("current_fatigue_level",this.detectionResult.label_name)}catch(e){}this.$router&&this.$router.push({path:"/music-recommendation"})}catch(e){O.nk.info("请在推荐页面查看推荐列表")}}}},j=n(6262);const P=(0,j.A)(T,[["render",C],["__scopeId","data-v-2645ad5f"]]);var W=P},397:function(e,t,n){var r=n(7751);e.exports=r("document","documentElement")},679:function(e,t,n){var r=n(1625),o=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw new o("Incorrect invocation")}},684:function(e){e.exports=function(e,t){var n="function"==typeof Iterator&&Iterator.prototype[e];if(n)try{n.call({next:null},t).next()}catch(r){return!0}}},1072:function(e,t,n){var r=n(1828),o=n(8727);e.exports=Object.keys||function(e){return r(e,o)}},1385:function(e,t,n){var r=n(9539);e.exports=function(e,t,n){for(var o=e.length-1;o>=0;o--)if(void 0!==e[o])try{n=r(e[o].iterator,t,n)}catch(a){t="throw",n=a}if("throw"===t)throw n;return n}},1701:function(e,t,n){var r=n(6518),o=n(9565),a=n(9306),i=n(8551),s=n(1767),l=n(9462),c=n(6319),u=n(9539),d=n(684),f=n(4549),p=n(6395),v=!p&&!d("map",function(){}),h=!p&&!v&&f("map",TypeError),m=p||v||h,y=l(function(){var e=this.iterator,t=i(o(this.next,e)),n=this.done=!!t.done;if(!n)return c(e,this.mapper,[t.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(e){i(this);try{a(e)}catch(t){u(this,"throw",t)}return h?o(h,this,e):new y(s(this),{mapper:e})}})},1767:function(e){e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},2106:function(e,t,n){var r=n(283),o=n(4913);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),o.f(e,t,n)}},2211:function(e,t,n){var r=n(9039);e.exports=!r(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},2360:function(e,t,n){var r,o=n(8551),a=n(6801),i=n(8727),s=n(421),l=n(397),c=n(4055),u=n(6119),d=">",f="<",p="prototype",v="script",h=u("IE_PROTO"),m=function(){},y=function(e){return f+v+d+e+f+"/"+v+d},g=function(e){e.write(y("")),e.close();var t=e.parentWindow.Object;return e=null,t},k=function(){var e,t=c("iframe"),n="java"+v+":";return t.style.display="none",l.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(y("document.F=Object")),e.close(),e.F},b=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}b="undefined"!=typeof document?document.domain&&r?g(r):k():g(r);var e=i.length;while(e--)delete b[p][i[e]];return b()};s[h]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(m[p]=o(e),n=new m,m[p]=null,n[h]=e):n=b(),void 0===t?n:a.f(n,t)}},2529:function(e){e.exports=function(e,t){return{value:e,done:t}}},2787:function(e,t,n){var r=n(9297),o=n(4901),a=n(8981),i=n(6119),s=n(2211),l=i("IE_PROTO"),c=Object,u=c.prototype;e.exports=s?c.getPrototypeOf:function(e){var t=a(e);if(r(t,l))return t[l];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof c?u:null}},4549:function(e,t,n){var r=n(4576);e.exports=function(e,t){var n=r.Iterator,o=n&&n.prototype,a=o&&o[e],i=!1;if(a)try{a.call({next:function(){return{done:!0}},return:function(){i=!0}},-1)}catch(s){s instanceof t||(i=!1)}if(!i)return a}},4659:function(e,t,n){var r=n(3724),o=n(4913),a=n(6980);e.exports=function(e,t,n){r?o.f(e,t,a(0,n)):e[t]=n}},6279:function(e,t,n){var r=n(6840);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},6319:function(e,t,n){var r=n(8551),o=n(9539);e.exports=function(e,t,n,a){try{return a?t(r(n)[0],n[1]):t(n)}catch(i){o(e,"throw",i)}}},6801:function(e,t,n){var r=n(3724),o=n(8686),a=n(4913),i=n(8551),s=n(5397),l=n(1072);t.f=r&&!o?Object.defineProperties:function(e,t){i(e);var n,r=s(t),o=l(t),c=o.length,u=0;while(c>u)a.f(e,n=o[u++],r[n]);return e}},7657:function(e,t,n){var r,o,a,i=n(9039),s=n(4901),l=n(34),c=n(2360),u=n(2787),d=n(6840),f=n(8227),p=n(6395),v=f("iterator"),h=!1;[].keys&&(a=[].keys(),"next"in a?(o=u(u(a)),o!==Object.prototype&&(r=o)):h=!0);var m=!l(r)||i(function(){var e={};return r[v].call(e)!==e});m?r={}:p&&(r=c(r)),s(r[v])||d(r,v,function(){return this}),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},8111:function(e,t,n){var r=n(6518),o=n(4576),a=n(679),i=n(8551),s=n(4901),l=n(2787),c=n(2106),u=n(4659),d=n(9039),f=n(9297),p=n(8227),v=n(7657).IteratorPrototype,h=n(3724),m=n(6395),y="constructor",g="Iterator",k=p("toStringTag"),b=TypeError,w=o[g],x=m||!s(w)||w.prototype!==v||!d(function(){w({})}),F=function(){if(a(this,v),l(this)===v)throw new b("Abstract class Iterator not directly constructable")},_=function(e,t){h?c(v,e,{configurable:!0,get:function(){return t},set:function(t){if(i(this),this===v)throw new b("You can't redefine this property");f(this,e)?this[e]=t:u(this,e,t)}}):v[e]=t};f(v,k)||_(k,g),!x&&f(v,y)&&v[y]!==Object||_(y,F),F.prototype=v,r({global:!0,constructor:!0,forced:x},{Iterator:F})},9462:function(e,t,n){var r=n(9565),o=n(2360),a=n(6699),i=n(6279),s=n(8227),l=n(1181),c=n(5966),u=n(7657).IteratorPrototype,d=n(2529),f=n(9539),p=n(1385),v=s("toStringTag"),h="IteratorHelper",m="WrapForValidIterator",y="normal",g="throw",k=l.set,b=function(e){var t=l.getterFor(e?m:h);return i(o(u),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return d(void 0,!0);try{var r=n.nextHandler();return n.returnHandlerResult?r:d(r,n.done)}catch(o){throw n.done=!0,o}},return:function(){var n=t(this),o=n.iterator;if(n.done=!0,e){var a=c(o,"return");return a?r(a,o):d(void 0,!0)}if(n.inner)try{f(n.inner.iterator,y)}catch(i){return f(o,g,i)}if(n.openIters)try{p(n.openIters,y)}catch(i){return f(o,g,i)}return o&&f(o,y),d(void 0,!0)}})},w=b(!0),x=b(!1);a(x,v,"Iterator Helper"),e.exports=function(e,t,n){var r=function(r,o){o?(o.iterator=r.iterator,o.next=r.next):o=r,o.type=t?m:h,o.returnHandlerResult=!!n,o.nextHandler=e,o.counter=0,o.done=!1,k(this,o)};return r.prototype=t?w:x,r}},9539:function(e,t,n){var r=n(9565),o=n(8551),a=n(5966);e.exports=function(e,t,n){var i,s;o(e);try{if(i=a(e,"return"),!i){if("throw"===t)throw n;return n}i=r(i,e)}catch(l){s=!0,i=l}if("throw"===t)throw n;if(s)throw i;return o(i),n}}}]);
//# sourceMappingURL=signal.7555e5b7.js.map