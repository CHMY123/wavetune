"use strict";(self["webpackChunkwavetune"]=self["webpackChunkwavetune"]||[]).push([[731],{397:function(e,t,n){var o=n(7751);e.exports=o("document","documentElement")},679:function(e,t,n){var o=n(1625),r=TypeError;e.exports=function(e,t){if(o(t,e))return e;throw new r("Incorrect invocation")}},684:function(e){e.exports=function(e,t){var n="function"==typeof Iterator&&Iterator.prototype[e];if(n)try{n.call({next:null},t).next()}catch(o){return!0}}},1072:function(e,t,n){var o=n(1828),r=n(8727);e.exports=Object.keys||function(e){return o(e,r)}},1385:function(e,t,n){var o=n(9539);e.exports=function(e,t,n){for(var r=e.length-1;r>=0;r--)if(void 0!==e[r])try{n=o(e[r].iterator,t,n)}catch(i){t="throw",n=i}if("throw"===t)throw n;return n}},1701:function(e,t,n){var o=n(6518),r=n(9565),i=n(9306),a=n(8551),l=n(1767),c=n(9462),s=n(6319),u=n(9539),d=n(684),f=n(4549),p=n(6395),g=!p&&!d("map",function(){}),v=!p&&!g&&f("map",TypeError),h=p||g||v,m=c(function(){var e=this.iterator,t=a(r(this.next,e)),n=this.done=!!t.done;if(!n)return s(e,this.mapper,[t.value,this.counter++],!0)});o({target:"Iterator",proto:!0,real:!0,forced:h},{map:function(e){a(this);try{i(e)}catch(t){u(this,"throw",t)}return v?r(v,this,e):new m(l(this),{mapper:e})}})},1767:function(e){e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},1990:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});n(8111),n(1701);var o=n(641),r=n(33);const i={class:"signal-monitor-view"},a={class:"top-section"},l={class:"header-content"},c={class:"status-info"},s={class:"signal-modules"},u={class:"card-header"},d={class:"signal-name"},f={class:"signal-data"},p={class:"data-value"},g={class:"value-text"},v={class:"value-unit"},h={class:"reference-range"},m={class:"waveform-container"},y={class:"waveform",viewBox:"0 0 400 120"},k=["d","stroke"],w={class:"bottom-section"},b={class:"timeline-section"},x={class:"timeline"},F={class:"time-marks"},_={class:"action-buttons"},S={key:0,class:"detection-result",style:{"margin-left":"12px",display:"flex","align-items":"center",gap:"8px"}},V={class:"prob"};function L(e,t,n,L,M,C){const I=(0,o.g2)("el-page-header"),R=(0,o.g2)("el-tag"),E=(0,o.g2)("el-badge"),O=(0,o.g2)("el-card"),T=(0,o.g2)("el-col"),j=(0,o.g2)("el-row"),P=(0,o.g2)("VideoPause"),W=(0,o.g2)("el-icon"),H=(0,o.g2)("el-button"),Q=(0,o.g2)("Download");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",a,[(0,o.Lk)("div",l,[(0,o.bF)(I,{content:"多模态生理信号实时监测",class:"page-title"}),(0,o.Lk)("div",c,[(0,o.bF)(R,{type:"success",size:"large"},{default:(0,o.k6)(()=>[...t[1]||(t[1]=[(0,o.eW)("监测中",-1)])]),_:1}),t[2]||(t[2]=(0,o.Lk)("span",{class:"device-status"},"设备已连接",-1))])]),t[3]||(t[3]=(0,o.Lk)("p",{class:"monitor-info"}," 当前监测信号：EEG、EOG、HRV、呼吸频率 ",-1))]),(0,o.Lk)("div",s,[(0,o.bF)(j,{gutter:16},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(M.signalModules,e=>((0,o.uX)(),(0,o.Wv)(T,{key:e.type,xs:24,sm:24,md:12,lg:12,xl:12},{default:(0,o.k6)(()=>[(0,o.bF)(O,{class:(0,r.C4)(["signal-card",e.status])},{header:(0,o.k6)(()=>[(0,o.Lk)("div",u,[(0,o.Lk)("span",d,(0,r.v_)(e.name),1),(0,o.bF)(E,{type:"normal"===e.status?"success":"danger",value:"normal"===e.status?"正常":"异常"},null,8,["type","value"])])]),default:(0,o.k6)(()=>[(0,o.Lk)("div",f,[(0,o.Lk)("div",p,[(0,o.Lk)("span",g,(0,r.v_)(e.value),1),(0,o.Lk)("span",v,(0,r.v_)(e.unit),1)]),(0,o.Lk)("div",h,(0,r.v_)(e.range),1)]),(0,o.Lk)("div",m,[((0,o.uX)(),(0,o.CE)("svg",y,[t[4]||(t[4]=(0,o.Lk)("line",{x1:"0",y1:"30",x2:"400",y2:"30",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),t[5]||(t[5]=(0,o.Lk)("line",{x1:"0",y1:"60",x2:"400",y2:"60",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),t[6]||(t[6]=(0,o.Lk)("line",{x1:"0",y1:"90",x2:"400",y2:"90",stroke:"#ddd","stroke-dasharray":"2,2"},null,-1)),(0,o.Lk)("path",{d:e.waveform,stroke:e.color,"stroke-width":"2",fill:"none",class:"waveform-path"},null,8,k)]))])]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})]),(0,o.Lk)("div",w,[(0,o.Lk)("div",b,[t[8]||(t[8]=(0,o.Lk)("div",{class:"timeline-header"},[(0,o.Lk)("span",{class:"timeline-title"},"监测时间轴"),(0,o.Lk)("span",{class:"current-time"},"当前时间: 00:03")],-1)),(0,o.Lk)("div",x,[(0,o.Lk)("div",F,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(M.timeMarks,e=>((0,o.uX)(),(0,o.CE)("span",{key:e,class:(0,r.C4)(["time-mark",{current:"00:03"===e}])},(0,r.v_)(e),3))),128))]),t[7]||(t[7]=(0,o.Lk)("div",{class:"timeline-progress"},[(0,o.Lk)("div",{class:"progress-line"}),(0,o.Lk)("div",{class:"current-indicator",style:{left:"60%"}})],-1))])]),(0,o.Lk)("div",_,[(0,o.bF)(H,{type:"default",size:"large"},{default:(0,o.k6)(()=>[(0,o.bF)(W,null,{default:(0,o.k6)(()=>[(0,o.bF)(P)]),_:1}),t[9]||(t[9]=(0,o.eW)(" 暂停监测 ",-1))]),_:1}),(0,o.bF)(H,{type:"primary",size:"large"},{default:(0,o.k6)(()=>[(0,o.bF)(W,null,{default:(0,o.k6)(()=>[(0,o.bF)(Q)]),_:1}),t[10]||(t[10]=(0,o.eW)(" 导出数据 ",-1))]),_:1}),(0,o.Lk)("input",{ref:"csvInput",type:"file",accept:".csv",style:{display:"none"},onChange:t[0]||(t[0]=(...e)=>C.onFileChange&&C.onFileChange(...e))},null,544),(0,o.bF)(H,{type:"info",size:"large",onClick:C.chooseFile,style:{"margin-left":"12px"}},{default:(0,o.k6)(()=>[...t[11]||(t[11]=[(0,o.eW)(" 选择 CSV ",-1)])]),_:1},8,["onClick"]),(0,o.bF)(H,{disabled:!M.selectedFile,loading:M.detecting,type:"success",size:"large",onClick:C.uploadCsvForDetection},{default:(0,o.k6)(()=>[...t[12]||(t[12]=[(0,o.eW)(" 上传检测 ",-1)])]),_:1},8,["disabled","loading","onClick"]),M.detectionResult?((0,o.uX)(),(0,o.CE)("div",S,[(0,o.bF)(R,{type:M.detectionResult.type||"warning"},{default:(0,o.k6)(()=>[(0,o.eW)("检测："+(0,r.v_)(M.detectionResult.label_name),1)]),_:1},8,["type"]),(0,o.Lk)("span",V,"概率: "+(0,r.v_)(M.detectionResult.probabilities.map(e=>e.toFixed(3)).join(" / ")),1),"Medium"===M.detectionResult.label_name||"High"===M.detectionResult.label_name?((0,o.uX)(),(0,o.Wv)(H,{key:0,type:"primary",size:"small",onClick:C.showRecommendations},{default:(0,o.k6)(()=>[...t[13]||(t[13]=[(0,o.eW)("查看推荐音乐",-1)])]),_:1},8,["onClick"])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])])])}n(4114);var M=n(8548),C=n(5720),I=n(163),R={name:"SignalMonitorView",components:{VideoPause:M.VideoPause,Download:M.Download},data(){return{signalModules:[{type:"EEG",name:"EEG 脑电信号",value:"4.2",unit:"μV²",range:"正常范围：5-8 μV²",status:"warning",color:"#1890ff",waveform:"M0,60 Q50,20 100,60 T200,60 T300,60 T400,60"},{type:"EOG",name:"EOG 眼电信号",value:"18.5",unit:"次/分",range:"正常范围：15-20 次/分",status:"normal",color:"#722ed1",waveform:"M0,60 Q100,30 200,60 Q300,90 400,60"},{type:"HRV",name:"心率变异性",value:"32.4",unit:"ms",range:"正常范围：30-50 ms",status:"normal",color:"#52c41a",waveform:"M0,60 Q50,40 100,60 Q150,80 200,60 Q250,40 300,60 Q350,80 400,60"},{type:"RESP",name:"呼吸频率",value:"16.2",unit:"次/分",range:"正常范围：12-20 次/分",status:"normal",color:"#fa8c16",waveform:"M0,60 Q100,40 200,60 Q300,80 400,60"}],selectedFileName:"",selectedFile:null,detecting:!1,detectionResult:null,timeMarks:["00:00","00:01","00:02","00:03","00:04","00:05"]}},created(){console.log("%c [SignalMonitorView] 组件创建完成","color: #1890ff; font-weight: bold;"),console.log("%c [SignalMonitorView] 初始化信号监测模块数据：","color: #722ed1;",this.signalModules)},methods:{chooseFile(){console.log("%c [SignalMonitorView] 触发选择CSV文件操作","color: #52c41a;"),this.$refs.csvInput?this.$refs.csvInput.click():console.warn("%c [SignalMonitorView] 未找到csvInput引用，无法触发文件选择","color: #fa8c16;")},onFileChange(e){console.log("%c [SignalMonitorView] 触发文件选择变更事件","color: #52c41a;");const t=e.target.files||e.dataTransfer?.files;if(!t||!t.length)return console.log("%c [SignalMonitorView] 未选择任何文件，清空当前文件状态","color: #fa8c16;"),this.selectedFile=null,void(this.selectedFileName="");const n=t[0];this.selectedFile=n,this.selectedFileName=n.name,console.log("%c [SignalMonitorView] 成功选择CSV文件：","color: #1890ff;",{"文件名":n.name,"文件大小":`${(n.size/1024).toFixed(2)} KB`,"文件类型":n.type})},async uploadCsvForDetection(){if(!this.selectedFile)return console.warn("%c [SignalMonitorView] 未选择CSV文件，无法执行上传检测","color: #faad14;"),void I.nk.warning("请先选择一个 CSV 文件");const e=new FormData;e.append("file",this.selectedFile),console.log("%c [SignalMonitorView] 构建FormData完成，准备上传文件","color: #1890ff;"),this.detecting=!0,this.detectionResult=null;try{console.log("%c [SignalMonitorView] 开始上传CSV文件并执行检测，请求地址：/detection/upload","color: #1890ff;");const t=await C.f.postForm("/detection/upload",e);console.log("%c [SignalMonitorView] 上传检测请求响应成功：","color: #52c41a;",t);const n=t.data||{};this.detectionResult={label:n.label,label_name:n.label_name||n.labelName||"Unknown",probabilities:n.probabilities||n.probs||[],type:"High"===n.label_name?"danger":"Medium"===n.label_name?"warning":"success"},console.log("%c [SignalMonitorView] 脑疲劳检测结果解析完成：","color: #722ed1;",this.detectionResult),I.nk.success(`检测完成：${this.detectionResult.label_name}`)}catch(t){console.error("%c [SignalMonitorView] 上传CSV文件或检测失败：","color: #f5222d;",t),I.nk.error("上传或检测失败，请检查文件格式（20×20）并重试")}finally{this.detecting=!1,console.log("%c [SignalMonitorView] 上传检测流程结束，重置detecting状态","color: #fa8c16;")}},showRecommendations(){console.log("%c [SignalMonitorView] 触发查看推荐音乐操作，当前疲劳等级：","color: #722ed1;",this.detectionResult.label_name);try{this.detectionResult&&this.detectionResult.label_name&&(localStorage.setItem("current_fatigue_level",this.detectionResult.label_name),console.log("%c [SignalMonitorView] 已将当前疲劳等级写入localStorage：","color: #1890ff;",this.detectionResult.label_name)),this.$router?(this.$router.push({path:"/music-recommendation"}),console.log("%c [SignalMonitorView] 成功跳转至音乐推荐页面","color: #52c41a;")):console.warn("%c [SignalMonitorView] 未找到$router实例，无法跳转","color: #faad14;")}catch(e){console.error("%c [SignalMonitorView] 跳转音乐推荐页面失败：","color: #f5222d;",e),I.nk.info("请在推荐页面查看推荐列表")}}}},E=n(6262);const O=(0,E.A)(R,[["render",L],["__scopeId","data-v-c7aef7bc"]]);var T=O},2106:function(e,t,n){var o=n(283),r=n(4913);e.exports=function(e,t,n){return n.get&&o(n.get,t,{getter:!0}),n.set&&o(n.set,t,{setter:!0}),r.f(e,t,n)}},2211:function(e,t,n){var o=n(9039);e.exports=!o(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},2360:function(e,t,n){var o,r=n(8551),i=n(6801),a=n(8727),l=n(421),c=n(397),s=n(4055),u=n(6119),d=">",f="<",p="prototype",g="script",v=u("IE_PROTO"),h=function(){},m=function(e){return f+g+d+e+f+"/"+g+d},y=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},k=function(){var e,t=s("iframe"),n="java"+g+":";return t.style.display="none",c.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(m("document.F=Object")),e.close(),e.F},w=function(){try{o=new ActiveXObject("htmlfile")}catch(t){}w="undefined"!=typeof document?document.domain&&o?y(o):k():y(o);var e=a.length;while(e--)delete w[p][a[e]];return w()};l[v]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(h[p]=r(e),n=new h,h[p]=null,n[v]=e):n=w(),void 0===t?n:i.f(n,t)}},2529:function(e){e.exports=function(e,t){return{value:e,done:t}}},2787:function(e,t,n){var o=n(9297),r=n(4901),i=n(8981),a=n(6119),l=n(2211),c=a("IE_PROTO"),s=Object,u=s.prototype;e.exports=l?s.getPrototypeOf:function(e){var t=i(e);if(o(t,c))return t[c];var n=t.constructor;return r(n)&&t instanceof n?n.prototype:t instanceof s?u:null}},4549:function(e,t,n){var o=n(4576);e.exports=function(e,t){var n=o.Iterator,r=n&&n.prototype,i=r&&r[e],a=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){a=!0}},-1)}catch(l){l instanceof t||(a=!1)}if(!a)return i}},4659:function(e,t,n){var o=n(3724),r=n(4913),i=n(6980);e.exports=function(e,t,n){o?r.f(e,t,i(0,n)):e[t]=n}},6279:function(e,t,n){var o=n(6840);e.exports=function(e,t,n){for(var r in t)o(e,r,t[r],n);return e}},6319:function(e,t,n){var o=n(8551),r=n(9539);e.exports=function(e,t,n,i){try{return i?t(o(n)[0],n[1]):t(n)}catch(a){r(e,"throw",a)}}},6801:function(e,t,n){var o=n(3724),r=n(8686),i=n(4913),a=n(8551),l=n(5397),c=n(1072);t.f=o&&!r?Object.defineProperties:function(e,t){a(e);var n,o=l(t),r=c(t),s=r.length,u=0;while(s>u)i.f(e,n=r[u++],o[n]);return e}},7657:function(e,t,n){var o,r,i,a=n(9039),l=n(4901),c=n(34),s=n(2360),u=n(2787),d=n(6840),f=n(8227),p=n(6395),g=f("iterator"),v=!1;[].keys&&(i=[].keys(),"next"in i?(r=u(u(i)),r!==Object.prototype&&(o=r)):v=!0);var h=!c(o)||a(function(){var e={};return o[g].call(e)!==e});h?o={}:p&&(o=s(o)),l(o[g])||d(o,g,function(){return this}),e.exports={IteratorPrototype:o,BUGGY_SAFARI_ITERATORS:v}},8111:function(e,t,n){var o=n(6518),r=n(4576),i=n(679),a=n(8551),l=n(4901),c=n(2787),s=n(2106),u=n(4659),d=n(9039),f=n(9297),p=n(8227),g=n(7657).IteratorPrototype,v=n(3724),h=n(6395),m="constructor",y="Iterator",k=p("toStringTag"),w=TypeError,b=r[y],x=h||!l(b)||b.prototype!==g||!d(function(){b({})}),F=function(){if(i(this,g),c(this)===g)throw new w("Abstract class Iterator not directly constructable")},_=function(e,t){v?s(g,e,{configurable:!0,get:function(){return t},set:function(t){if(a(this),this===g)throw new w("You can't redefine this property");f(this,e)?this[e]=t:u(this,e,t)}}):g[e]=t};f(g,k)||_(k,y),!x&&f(g,m)&&g[m]!==Object||_(m,F),F.prototype=g,o({global:!0,constructor:!0,forced:x},{Iterator:F})},9462:function(e,t,n){var o=n(9565),r=n(2360),i=n(6699),a=n(6279),l=n(8227),c=n(1181),s=n(5966),u=n(7657).IteratorPrototype,d=n(2529),f=n(9539),p=n(1385),g=l("toStringTag"),v="IteratorHelper",h="WrapForValidIterator",m="normal",y="throw",k=c.set,w=function(e){var t=c.getterFor(e?h:v);return a(r(u),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return d(void 0,!0);try{var o=n.nextHandler();return n.returnHandlerResult?o:d(o,n.done)}catch(r){throw n.done=!0,r}},return:function(){var n=t(this),r=n.iterator;if(n.done=!0,e){var i=s(r,"return");return i?o(i,r):d(void 0,!0)}if(n.inner)try{f(n.inner.iterator,m)}catch(a){return f(r,y,a)}if(n.openIters)try{p(n.openIters,m)}catch(a){return f(r,y,a)}return r&&f(r,m),d(void 0,!0)}})},b=w(!0),x=w(!1);i(x,g,"Iterator Helper"),e.exports=function(e,t,n){var o=function(o,r){r?(r.iterator=o.iterator,r.next=o.next):r=o,r.type=t?h:v,r.returnHandlerResult=!!n,r.nextHandler=e,r.counter=0,r.done=!1,k(this,r)};return o.prototype=t?b:x,o}},9539:function(e,t,n){var o=n(9565),r=n(8551),i=n(5966);e.exports=function(e,t,n){var a,l;r(e);try{if(a=i(e,"return"),!a){if("throw"===t)throw n;return n}a=o(a,e)}catch(c){l=!0,a=c}if("throw"===t)throw n;if(l)throw a;return r(a),n}}}]);
//# sourceMappingURL=signal.f95b48b7.js.map